# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# AI WORKFLOW RULES FRAMEWORK v9.1.1
# Tool: Cursor IDE
# Auto-generated - DO NOT EDIT MANUALLY
# Update via: npm run sync-rules (or bash scripts/sync-rules.sh)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ðŸ”´ TOKEN PRE-FLIGHT CHECK (MANDATORY!)

**BEFORE ANY task >20k tokens:**
1. ASK: "How many tokens used TODAY?"
2. CALCULATE: remaining = daily_limit - daily_used
3. IF insufficient â†’ STOP + WARN + GET APPROVAL
4. NEVER start without check!

**Failure = 2 days downtime!**

## ðŸ”´ AI BEHAVIOR RULES (CRITICAL - NON-NEGOTIABLE!)

> **Added 2026-02-10 from ROADMAP Phase 1 - Override ALL other considerations!**

### Rule #1: ÐšÐÐ§Ð•Ð¡Ð¢Ð’Ðž > Ð¡ÐšÐžÐ ÐžÐ¡Ð¢Ð¬ (Quality > Speed)
- âœ… Attention to details - ALWAYS
- âœ… Quality > Speed - NOT negotiable
- âœ… Thorough approach to every task
- âŒ NEVER skip steps to save time/tokens
- âŒ NEVER "quick verification" instead of detailed work

### Rule #2: "I Don't Know" Honesty
- âœ… Think HARDER before answering
- âœ… If uncertain â†’ say "I don't know"
- âœ… If guessing â†’ state it's a guess
- âœ… If need to check â†’ check FIRST
- âŒ NEVER fabricate facts/data
- âŒ NEVER pretend to know

### Rule #3: Token Status After EVERY Phase
After EVERY phase/stage completion:
```
[PHASE X COMPLETE]
Session: Xk/200k (Y%)
Daily: ~Xk today (self-reported, Â±30-50%)
Status: ðŸŸ¢/ðŸŸ¡/ðŸŸ /ðŸ”´

Next: [description] (~Nk estimate)
ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ? [Y/n]
```
âŒ NEVER start next phase without user approval
âŒ NEVER show fake daily % like "Zk/150k (W%)" â€” 150k is NOT a real limit

### Rule #4: No Auto-Commit/Push
- âŒ NEVER auto-commit
- âŒ NEVER auto-push
- âœ… ONLY when explicitly requested
- âœ… After phase â†’ PROPOSE (don't execute)

**These rules are MORE important than token savings!**

---

## ðŸš€ SESSION START PROTOCOL (MANDATORY)

**BEFORE any work in this project, you MUST:**

1. **Load project context:**
   - Read `.ai/config.json` to get selected context
   - Load appropriate context from `.ai/contexts/[context].context.md`
   - Context options: minimal, ukraine

2. **Load enforcement protocols:**
   - Read `.ai/AI-ENFORCEMENT.md` for mandatory workflows
   - Includes: post-push compression, lint checks, token management

3. **Display SESSION START confirmation:**

```markdown
[SESSION START]
âœ“ Context loaded: [context_name] (~Xk tokens, v9.1 optimized)
âœ“ Token budget: ~Xk for rules (Y% of daily)
âœ“ Language: Adaptive (matches user's language)
âœ“ Token limit: Zk daily
âœ“ Current usage: Ak (B%) | Remaining: ~Ck
âœ“ Status: [ðŸŸ¢/ðŸŸ¡/ðŸŸ /ðŸ”´] [Zone description]

Ð§Ñ–Ð¼ Ñ Ð¼Ð¾Ð¶Ñƒ Ð²Ð°Ð¼ Ð´Ð¾Ð¿Ð¾Ð¼Ð¾Ð³Ñ‚Ð¸? (or adapt to user's language)
```

4. **Follow core principles from loaded context**

---

## ðŸ“ PROJECT STRUCTURE

```
.ai/                        # AI Framework Hub (v9.1)
â”œâ”€â”€ contexts/               # Context presets (load at session start)
â”‚   â”œâ”€â”€ minimal.context.md     (~10k tokens)
â”‚   â””â”€â”€ ukraine.context.md     (~18k tokens)
â”œâ”€â”€ docs/                   # Documentation
â”‚   â”œâ”€â”€ quickstart.md
â”‚   â”œâ”€â”€ cheatsheet.md
â”‚   â”œâ”€â”€ session-mgmt.md
â”‚   â”œâ”€â”€ code-quality.md
â”‚   â””â”€â”€ ...
â”œâ”€â”€ rules/                  # Full rules reference
â”‚   â”œâ”€â”€ core.md             # Complete workflow rules
â”‚   â””â”€â”€ product.md          # Ukrainian market specifics
â”œâ”€â”€ config.json             # Your configuration
â”œâ”€â”€ token-limits.json       # Token budget tracking
â””â”€â”€ AI-ENFORCEMENT.md       # Mandatory protocols
```

---

## ðŸ“Š //TOKENS Protocol (Phase 11 â€” Token Self-Reporting)

**When user types `//TOKENS`:**
1. **Read** `.ai/session-log.json` (if exists)
2. **Check date** of last entry vs today (`YYYY-MM-DD`)
3. **Calculate** daily total: sum all entries where `date == today`
4. **Estimate** current session tokens (rough Â±30-50%)
5. **Estimate context_pct** = round(session_tokens / context_window Ã— 100)
6. **Burst check**: count today's entries where `context_pct > 60`. If 3+ â†’ Rate Layer = "ðŸŸ  High load"
7. **Append** new entry to `session-log.json`:
   ```json
   {"date": "YYYY-MM-DD", "tokens": ESTIMATE, "context_pct": X, "tool": "cursor", "trigger": "//tokens", "timestamp": UNIX_NOW}
   ```
8. **Display** [AI STATUS] â€” 3-Layer Mental Model:
   ```
   [AI STATUS] ðŸŸ¢ GREEN
   Provider: Cursor Â· [PLAN]

   Context  â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  Y%  ~Xk / 200k
   Rate     ðŸŸ¢ Normal / ðŸŸ  High load
   Billing  N/A
   Daily    ~Zk today
   ```
7. **If session-log.json missing:** Create it (copy schema from `.ai/session-log.json`)

**`//start` â€” Session boundary marker (Phase 11.5):**
- Read `session-log.json`, get `LAST_TS` = last entry's timestamp (0 if none)
- `GAP = NOW - LAST_TS`
- IF GAP > 7200s (2h): write `{tokens: 0, trigger: "session-start", timestamp: NOW}` â†’ show "ðŸŸ¢ New session started"
- IF GAP < 7200s: context refresh only â€” do NOT write â†’ show "ðŸ“Š Continuing session"

**Also write to log at:**
- `//COMPACT` trigger â†’ append entry, then compress
- After `git push` â†’ append entry (POST-PUSH PROTOCOL)
- Phase completion â†’ append entry

**CRITICAL:** **Billing Layer** determined by `access_type` in `.ai/config.json`:
- `"subscription"` (or missing) â†’ `N/A (subscription)`
- `"billing"` â†’ calculate cost from `billing` block, compare to `billing.daily_budget_usd`
NEVER fabricate limits or percentages.

**Graceful degradation (if can't write files):**
Display session estimate only + explain why log unavailable.

---

## ðŸŽ¯ KEY COMMANDS

```bash
//START          - Execute session start protocol
//TOKENS         - Show token usage status
//COMPACT        - Compress context (save 40-60% tokens)
//THINK          - Show AI reasoning
//CHECK:SECURITY - Security audit
//CHECK:LANG     - Language compliance check
//CHECK:ALL      - Full audit
//CHECK:RULES    - Display full protocol checklist + confirm active rules
//REFRESH        - Re-read RULES-CRITICAL.md + AI-ENFORCEMENT.md (anti-amnesia)
//WHICH:RULES    - Show which protocols apply to current operation
```

---

## ðŸ”’ SECURITY (Zero Tolerance)

**NEVER:**
- âŒ Hardcode secrets (API keys, passwords)
- âŒ Use russian tracking services (Yandex, VK, Mail.ru)
- âŒ Commit secrets to git
- âŒ Skip pre-commit hooks

**ALWAYS:**
- âœ… Use `process.env.VAR` for secrets
- âœ… Add error handling (try/catch, null checks)
- âœ… Follow Ukrainian market policy (if ukraine context)

---

## ðŸ’¡ WORKFLOW

1. **Discuss â†’ Approve â†’ Execute** (never code before approval)
2. **One stage = one commit** (atomic commits)
3. **Token-conscious** (monitor usage, optimize at 50%+)
4. **Post-push compression** (mandatory after git push)

---

## ðŸ“Š TOKEN ZONES

- ðŸŸ¢ **0-50% (GREEN):** Full capacity, normal mode
- ðŸŸ¡ **50-70% (MODERATE):** Brief mode, optimizations active
- ðŸŸ  **70-90% (CAUTION):** Silent mode, aggressive compression
- ðŸ”´ **90-95% (CRITICAL):** Finalization only, commit + stop

---

## ðŸ†˜ NAVIGATION

- **Entry point:** [AGENTS.md](AGENTS.md) - Navigation hub
- **Quick start:** [.ai/docs/quickstart.md](.ai/docs/quickstart.md)
- **Full rules:** [.ai/rules/core.md](.ai/rules/core.md)
- **Session management:** [.ai/docs/session-mgmt.md](.ai/docs/session-mgmt.md)
- **Code quality:** [.ai/docs/code-quality.md](.ai/docs/code-quality.md)

---

## âš ï¸ RED FLAGS - Auto-Stop

**STOP and ask confirmation before:**
- Deleting >10 files
- Changing core configs (`package.json`, `tsconfig`)
- Database migrations
- `rm -rf` or recursive deletes
- Publishing to production
- **[LANG-CRITICAL]** Russian content detected
- **[TOKEN-CRITICAL]** >95% tokens used

---

**Framework:** AI Workflow Rules v9.1 (Optimization Release)
**Made in Ukraine ðŸ‡ºðŸ‡¦**
**GitHub:** https://github.com/Shamavision/ai-workflow-rules

---

**NOTE:** This file is auto-generated from selected context.
To update: Run `npm run sync-rules` or `bash scripts/sync-rules.sh`
To change context: Edit `.ai/config.json` â†’ Run sync-rules
